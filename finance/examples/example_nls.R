library( nls2 )

ImpliedVol = c( 0.407050282501462, 0.377853542549804, 0.358774383966729, 0.350155732140927, 0.323869884887909, 0.316045726135599, 0.299212453546628, 0.291984217357641, 0.284858978744065, 0.276960507697133, 0.269948474050255, 0.261728711611685, 0.255464127656581, 0.247170172716369, 0.241780312999735, 0.233948528199048, 0.228071362891333, 0.221160400909263, 0.215299809803535, 0.209001013492208, 0.203245542090035, 0.197612959076664, 0.191685671237772, 0.186443255091288, 0.18112406689844, 0.176027411232061, 0.1711127187811, 0.166350163834852, 0.161724901026626, 0.1581736371874, 0.153953198480957, 0.147752612127608, 0.146549449960256, 0.143852135439699, 0.140801922116105 );

log_k = c( -0.210739667505634, -0.18383221458571, -0.1662879049348, -0.157629842191686, -0.132096540186521, -0.123728290516004, -0.107198988564794, -0.099035677925633, -0.0909384676930135, -0.0829062959957493, -0.0749381263465724, -0.0670329468394591, -0.0591897693784333, -0.0514076289363783, -0.043685582842468, -0.0360227100968988, -0.0284181107116795, -0.0208709050762966, -0.013380233347139, -0.00594525485962092, 0.00143485243800152, 0.00876089253007464, 0.0160336518591544, 0.0232538998326415, 0.030422389311254, 0.037539857080118, 0.0446070243032104, 0.051624596961857, 0.0585932662779503, 0.065513709122524, 0.0723865884102861, 0.079212553480686, 0.0859922404660647, 0.0927262726474088, 0.0994152607982054 );


formula = ImpliedVol^2 ~ ( a + b * ( rho * ( log_k - m ) + sqrt( ( log_k - m ) * ( log_k - m ) + sigma * sigma ) ) )

start.grid = expand.grid( a = seq( 0, .2, len = 6 ), b = seq( 0, 2, len = 6 ), sigma = seq( .01, 1, len = 6 ), 
  			rho = seq( -2, 1 ), len = 6, m = seq( -.3, .3, len = 6 ) );

mod1 = nls2( formula = formula, start = start.grid, algorithm = 'brute-force' );

nls2( formula = formula, start = mod1 );

